98967d8a7f46e5e8213955e3448539b4
'use strict';var invariant=require('fbjs/lib/invariant');var TRACE_TAG_REACT_APPS=1<<17;var TRACE_TAG_JSC_CALLS=1<<27;var _enabled=false;var _asyncCookie=0;var _markStack=[];var _markStackIndex=-1;var _canInstallReactHook=false;var _useFiber=false;var REACT_MARKER='\u269B';var userTimingPolyfill=__DEV__?{mark:function mark(markName){if(_enabled){_markStackIndex++;_markStack[_markStackIndex]=markName;var systraceLabel=markName;if(markName[0]===REACT_MARKER){var indexOfId=markName.lastIndexOf(' (#');var cutoffIndex=indexOfId!==-1?indexOfId:markName.length;systraceLabel=markName.slice(2,cutoffIndex);}Systrace.beginEvent(systraceLabel);}},measure:function measure(measureName,startMark,endMark){if(_enabled){invariant(typeof measureName==='string'&&typeof startMark==='string'&&typeof endMark==='undefined','Only performance.measure(string, string) overload is supported.');var topMark=_markStack[_markStackIndex];invariant(startMark===topMark,'There was a mismatching performance.measure() call. '+'Expected "%s" but got "%s."',topMark,startMark);_markStackIndex--;Systrace.endEvent();}},clearMarks:function clearMarks(markName){if(_enabled){if(_markStackIndex===-1){return;}if(markName===_markStack[_markStackIndex]){if(userTimingPolyfill!=null){userTimingPolyfill.measure(markName,markName);}}}},clearMeasures:function clearMeasures(){}}:null;var reactDebugToolHook=__DEV__?{onBeforeMountComponent:function onBeforeMountComponent(debugID){var ReactComponentTreeHook=require('ReactGlobalSharedState').ReactComponentTreeHook;var displayName=ReactComponentTreeHook.getDisplayName(debugID);Systrace.beginEvent('ReactReconciler.mountComponent('+displayName+')');},onMountComponent:function onMountComponent(debugID){Systrace.endEvent();},onBeforeUpdateComponent:function onBeforeUpdateComponent(debugID){var ReactComponentTreeHook=require('ReactGlobalSharedState').ReactComponentTreeHook;var displayName=ReactComponentTreeHook.getDisplayName(debugID);Systrace.beginEvent('ReactReconciler.updateComponent('+displayName+')');},onUpdateComponent:function onUpdateComponent(debugID){Systrace.endEvent();},onBeforeUnmountComponent:function onBeforeUnmountComponent(debugID){var ReactComponentTreeHook=require('ReactGlobalSharedState').ReactComponentTreeHook;var displayName=ReactComponentTreeHook.getDisplayName(debugID);Systrace.beginEvent('ReactReconciler.unmountComponent('+displayName+')');},onUnmountComponent:function onUnmountComponent(debugID){Systrace.endEvent();},onBeginLifeCycleTimer:function onBeginLifeCycleTimer(debugID,timerType){var ReactComponentTreeHook=require('ReactGlobalSharedState').ReactComponentTreeHook;var displayName=ReactComponentTreeHook.getDisplayName(debugID);Systrace.beginEvent(displayName+'.'+timerType+'()');},onEndLifeCycleTimer:function onEndLifeCycleTimer(debugID,timerType){Systrace.endEvent();}}:null;var Systrace={installReactHook:function installReactHook(useFiber){if(_enabled){if(__DEV__){if(useFiber){global.performance=userTimingPolyfill;}else{require('ReactDebugTool').addHook(reactDebugToolHook);}}}_useFiber=useFiber;_canInstallReactHook=true;},setEnabled:function setEnabled(enabled){if(_enabled!==enabled){if(__DEV__){if(enabled){global.nativeTraceBeginLegacy&&global.nativeTraceBeginLegacy(TRACE_TAG_JSC_CALLS);}else{global.nativeTraceEndLegacy&&global.nativeTraceEndLegacy(TRACE_TAG_JSC_CALLS);}if(_canInstallReactHook){if(_useFiber){global.performance=enabled?userTimingPolyfill:undefined;}else{var ReactDebugTool=require('ReactDebugTool');if(enabled){ReactDebugTool.addHook(reactDebugToolHook);}else{ReactDebugTool.removeHook(reactDebugToolHook);}}}}_enabled=enabled;}},isEnabled:function isEnabled(){return _enabled;},beginEvent:function beginEvent(profileName,args){if(_enabled){profileName=typeof profileName==='function'?profileName():profileName;global.nativeTraceBeginSection(TRACE_TAG_REACT_APPS,profileName,args);}},endEvent:function endEvent(){if(_enabled){global.nativeTraceEndSection(TRACE_TAG_REACT_APPS);}},beginAsyncEvent:function beginAsyncEvent(profileName){var cookie=_asyncCookie;if(_enabled){_asyncCookie++;profileName=typeof profileName==='function'?profileName():profileName;global.nativeTraceBeginAsyncSection(TRACE_TAG_REACT_APPS,profileName,cookie,0);}return cookie;},endAsyncEvent:function endAsyncEvent(profileName,cookie){if(_enabled){profileName=typeof profileName==='function'?profileName():profileName;global.nativeTraceEndAsyncSection(TRACE_TAG_REACT_APPS,profileName,cookie,0);}},counterEvent:function counterEvent(profileName,value){if(_enabled){profileName=typeof profileName==='function'?profileName():profileName;global.nativeTraceCounter&&global.nativeTraceCounter(TRACE_TAG_REACT_APPS,profileName,value);}},attachToRelayProfiler:function attachToRelayProfiler(relayProfiler){relayProfiler.attachProfileHandler('*',function(name){var cookie=Systrace.beginAsyncEvent(name);return function(){Systrace.endAsyncEvent(name,cookie);};});relayProfiler.attachAggregateHandler('*',function(name,callback){Systrace.beginEvent(name);callback();Systrace.endEvent();});},swizzleJSON:function swizzleJSON(){Systrace.measureMethods(JSON,'JSON',['parse','stringify']);},measureMethods:function measureMethods(object,objectName,methodNames){if(!__DEV__){return;}methodNames.forEach(function(methodName){object[methodName]=Systrace.measure(objectName,methodName,object[methodName]);});},measure:function measure(objName,fnName,func){if(!__DEV__){return func;}var profileName=objName+'.'+fnName;return function(){if(!_enabled){return func.apply(this,arguments);}Systrace.beginEvent(profileName);var ret=func.apply(this,arguments);Systrace.endEvent();return ret;};}};if(__DEV__){require.Systrace=Systrace;}module.exports=Systrace;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlN5c3RyYWNlLmpzIl0sIm5hbWVzIjpbImludmFyaWFudCIsInJlcXVpcmUiLCJUUkFDRV9UQUdfUkVBQ1RfQVBQUyIsIlRSQUNFX1RBR19KU0NfQ0FMTFMiLCJfZW5hYmxlZCIsIl9hc3luY0Nvb2tpZSIsIl9tYXJrU3RhY2siLCJfbWFya1N0YWNrSW5kZXgiLCJfY2FuSW5zdGFsbFJlYWN0SG9vayIsIl91c2VGaWJlciIsIlJFQUNUX01BUktFUiIsInVzZXJUaW1pbmdQb2x5ZmlsbCIsIl9fREVWX18iLCJtYXJrIiwibWFya05hbWUiLCJzeXN0cmFjZUxhYmVsIiwiaW5kZXhPZklkIiwibGFzdEluZGV4T2YiLCJjdXRvZmZJbmRleCIsImxlbmd0aCIsInNsaWNlIiwiU3lzdHJhY2UiLCJiZWdpbkV2ZW50IiwibWVhc3VyZSIsIm1lYXN1cmVOYW1lIiwic3RhcnRNYXJrIiwiZW5kTWFyayIsInRvcE1hcmsiLCJlbmRFdmVudCIsImNsZWFyTWFya3MiLCJjbGVhck1lYXN1cmVzIiwicmVhY3REZWJ1Z1Rvb2xIb29rIiwib25CZWZvcmVNb3VudENvbXBvbmVudCIsImRlYnVnSUQiLCJSZWFjdENvbXBvbmVudFRyZWVIb29rIiwiZGlzcGxheU5hbWUiLCJnZXREaXNwbGF5TmFtZSIsIm9uTW91bnRDb21wb25lbnQiLCJvbkJlZm9yZVVwZGF0ZUNvbXBvbmVudCIsIm9uVXBkYXRlQ29tcG9uZW50Iiwib25CZWZvcmVVbm1vdW50Q29tcG9uZW50Iiwib25Vbm1vdW50Q29tcG9uZW50Iiwib25CZWdpbkxpZmVDeWNsZVRpbWVyIiwidGltZXJUeXBlIiwib25FbmRMaWZlQ3ljbGVUaW1lciIsImluc3RhbGxSZWFjdEhvb2siLCJ1c2VGaWJlciIsImdsb2JhbCIsInBlcmZvcm1hbmNlIiwiYWRkSG9vayIsInNldEVuYWJsZWQiLCJlbmFibGVkIiwibmF0aXZlVHJhY2VCZWdpbkxlZ2FjeSIsIm5hdGl2ZVRyYWNlRW5kTGVnYWN5IiwidW5kZWZpbmVkIiwiUmVhY3REZWJ1Z1Rvb2wiLCJyZW1vdmVIb29rIiwiaXNFbmFibGVkIiwicHJvZmlsZU5hbWUiLCJhcmdzIiwibmF0aXZlVHJhY2VCZWdpblNlY3Rpb24iLCJuYXRpdmVUcmFjZUVuZFNlY3Rpb24iLCJiZWdpbkFzeW5jRXZlbnQiLCJjb29raWUiLCJuYXRpdmVUcmFjZUJlZ2luQXN5bmNTZWN0aW9uIiwiZW5kQXN5bmNFdmVudCIsIm5hdGl2ZVRyYWNlRW5kQXN5bmNTZWN0aW9uIiwiY291bnRlckV2ZW50IiwidmFsdWUiLCJuYXRpdmVUcmFjZUNvdW50ZXIiLCJhdHRhY2hUb1JlbGF5UHJvZmlsZXIiLCJyZWxheVByb2ZpbGVyIiwiYXR0YWNoUHJvZmlsZUhhbmRsZXIiLCJuYW1lIiwiYXR0YWNoQWdncmVnYXRlSGFuZGxlciIsImNhbGxiYWNrIiwic3dpenpsZUpTT04iLCJtZWFzdXJlTWV0aG9kcyIsIkpTT04iLCJvYmplY3QiLCJvYmplY3ROYW1lIiwibWV0aG9kTmFtZXMiLCJmb3JFYWNoIiwibWV0aG9kTmFtZSIsIm9iak5hbWUiLCJmbk5hbWUiLCJmdW5jIiwiYXBwbHkiLCJhcmd1bWVudHMiLCJyZXQiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiQUFXQSxhQUVBLEdBQU1BLFdBQVlDLFFBQVEsb0JBQVIsQ0FBbEIsQ0FlQSxHQUFNQyxzQkFBdUIsR0FBSyxFQUFsQyxDQUNBLEdBQU1DLHFCQUFzQixHQUFLLEVBQWpDLENBRUEsR0FBSUMsVUFBVyxLQUFmLENBQ0EsR0FBSUMsY0FBZSxDQUFuQixDQUNBLEdBQU1DLFlBQWEsRUFBbkIsQ0FDQSxHQUFJQyxpQkFBa0IsQ0FBQyxDQUF2QixDQUNBLEdBQUlDLHNCQUF1QixLQUEzQixDQUNBLEdBQUlDLFdBQVksS0FBaEIsQ0FJQSxHQUFNQyxjQUFlLFFBQXJCLENBQ0EsR0FBTUMsb0JBQXFCQyxRQUFVLENBQ25DQyxJQURtQyxlQUM5QkMsUUFEOEIsQ0FDWixDQUNyQixHQUFJVixRQUFKLENBQWMsQ0FDWkcsa0JBQ0FELFdBQVdDLGVBQVgs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bkJKLE9BQU9JLFVBQVAsQ0FIbUIsQ0FBckIsQ0FLRCxDQU5ELEVBT0QsQ0FqSmUsQ0E0SmhCNUQsT0E1SmdCLGtCQTRKUjZELE9BNUpRLENBNEpTQyxNQTVKVCxDQTRKeUJDLElBNUp6QixDQTRKeUMsQ0FDdkQsR0FBSSxDQUFDMUUsT0FBTCxDQUFjLENBQ1osTUFBTzBFLEtBQVAsQ0FDRCxDQUVELEdBQU01QixhQUFpQjBCLE9BQWpCLEtBQTRCQyxNQUFsQyxDQUNBLE1BQU8sV0FBVyxDQUNoQixHQUFJLENBQUNqRixRQUFMLENBQWUsQ0FDYixNQUFPa0YsTUFBS0MsS0FBTCxDQUFXLElBQVgsQ0FBaUJDLFNBQWpCLENBQVAsQ0FDRCxDQUVEbkUsU0FBU0MsVUFBVCxDQUFvQm9DLFdBQXBCLEVBQ0EsR0FBTStCLEtBQU1ILEtBQUtDLEtBQUwsQ0FBVyxJQUFYLENBQWlCQyxTQUFqQixDQUFaLENBQ0FuRSxTQUFTTyxRQUFULEdBQ0EsTUFBTzZELElBQVAsQ0FDRCxDQVRELENBVUQsQ0E1S2UsQ0FBakIsQ0ErS0EsR0FBSTdFLE9BQUosQ0FBYSxDQUtWWCxPQUFELENBQWVvQixRQUFmLENBQTBCQSxRQUExQixDQUNELENBRURxRSxPQUFPQyxPQUFQLENBQWlCdEUsUUFBakIiLCJmaWxlIjoiU3lzdHJhY2UuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNS1wcmVzZW50LCBGYWNlYm9vaywgSW5jLlxuICogQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBCU0Qtc3R5bGUgbGljZW5zZSBmb3VuZCBpbiB0aGVcbiAqIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBkaXJlY3Rvcnkgb2YgdGhpcyBzb3VyY2UgdHJlZS4gQW4gYWRkaXRpb25hbCBncmFudFxuICogb2YgcGF0ZW50IHJpZ2h0cyBjYW4gYmUgZm91bmQgaW4gdGhlIFBBVEVOVFMgZmlsZSBpbiB0aGUgc2FtZSBkaXJlY3RvcnkuXG4gKlxuICogQHByb3ZpZGVzTW9kdWxlIFN5c3RyYWNlXG4gKiBAZmxvd1xuICovXG4ndXNlIHN0cmljdCc7XG5cbmNvbnN0IGludmFyaWFudCA9IHJlcXVpcmUoJ2ZianMvbGliL2ludmFyaWFudCcpO1xuXG50eXBlIFJlbGF5UHJvZmlsZXIgPSB7XG4gIGF0dGFjaFByb2ZpbGVIYW5kbGVyKFxuICAgIG5hbWU6IHN0cmluZyxcbiAgICBoYW5kbGVyOiAobmFtZTogc3RyaW5nLCBzdGF0ZT86IGFueSkgPT4gKCkgPT4gdm9pZFxuICApOiB2b2lkLFxuXG4gIGF0dGFjaEFnZ3JlZ2F0ZUhhbmRsZXIoXG4gICAgbmFtZTogc3RyaW5nLFxuICAgIGhhbmRsZXI6IChuYW1lOiBzdHJpbmcsIGNhbGxiYWNrOiAoKSA9PiB2b2lkKSA9PiB2b2lkXG4gICk6IHZvaWQsXG59O1xuXG4vKiBlc2xpbnQgbm8tYml0d2lzZTogMCAqL1xuY29uc3QgVFJBQ0VfVEFHX1JFQUNUX0FQUFMgPSAxIDw8IDE3O1xuY29uc3QgVFJBQ0VfVEFHX0pTQ19DQUxMUyA9IDEgPDwgMjc7XG5cbmxldCBfZW5hYmxlZCA9IGZhbHNlO1xubGV0IF9hc3luY0Nvb2tpZSA9IDA7XG5jb25zdCBfbWFya1N0YWNrID0gW107XG5sZXQgX21hcmtTdGFja0luZGV4ID0gLTE7XG5sZXQgX2Nhbkluc3RhbGxSZWFjdEhvb2sgPSBmYWxzZTtcbmxldCBfdXNlRmliZXIgPSBmYWxzZTtcblxuLy8gSW1wbGVtZW50cyBhIHN1YnNldCBvZiBVc2VyIFRpbWluZyBBUEkgbmVjZXNzYXJ5IGZvciBSZWFjdCBtZWFzdXJlbWVudHMuXG4vLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvVXNlcl9UaW1pbmdfQVBJXG5jb25zdCBSRUFDVF9NQVJLRVIgPSAnXFx1MjY5Qic7XG5jb25zdCB1c2VyVGltaW5nUG9seWZpbGwgPSBfX0RFVl9fID8ge1xuICBtYXJrKG1hcmtOYW1lOiBzdHJpbmcpIHtcbiAgICBpZiAoX2VuYWJsZWQpIHtcbiAgICAgIF9tYXJrU3RhY2tJbmRleCsrO1xuICAgICAgX21hcmtTdGFja1tfbWFya1N0YWNrSW5kZXhdID0gbWFya05hbWU7XG4gICAgICBsZXQgc3lzdHJhY2VMYWJlbCA9IG1hcmtOYW1lO1xuICAgICAgLy8gU2luY2UgcGVyZiBtZWFzdXJlbWVudHMgYXJlIGEgc2hhcmVkIG5hbWVzcGFjZSBpbiBVc2VyIFRpbWluZyBBUEksXG4gICAgICAvLyB3ZSBwcmVmaXggYWxsIFJlYWN0IHJlc3VsdHMgd2l0aCBhIFJlYWN0IGVtb2ppLlxuICAgICAgaWYgKG1hcmtOYW1lWzBdID09PSBSRUFDVF9NQVJLRVIpIHtcbiAgICAgICAgLy8gVGhpcyBpcyBjb21pbmcgZnJvbSBSZWFjdC5cbiAgICAgICAgLy8gUmVtb3ZpbmcgY29tcG9uZW50IElEcyBrZWVwcyB0cmFjZSBjb2xvcnMgc3RhYmxlLlxuICAgICAgICBjb25zdCBpbmRleE9mSWQgPSBtYXJrTmFtZS5sYXN0SW5kZXhPZignICgjJyk7XG4gICAgICAgIGNvbnN0IGN1dG9mZkluZGV4ID0gaW5kZXhPZklkICE9PSAtMSA/IGluZGV4T2ZJZCA6IG1hcmtOYW1lLmxlbmd0aDtcbiAgICAgICAgLy8gQWxzbyBjdXQgb2ZmIHRoZSBlbW9qaSBiZWNhdXNlIGl0IGJyZWFrcyBTeXN0cmFjZVxuICAgICAgICBzeXN0cmFjZUxhYmVsID0gbWFya05hbWUuc2xpY2UoMiwgY3V0b2ZmSW5kZXgpO1xuICAgICAgfVxuICAgICAgU3lzdHJhY2UuYmVnaW5FdmVudChzeXN0cmFjZUxhYmVsKTtcbiAgICB9XG4gIH0sXG4gIG1lYXN1cmUobWVhc3VyZU5hbWU6IHN0cmluZywgc3RhcnRNYXJrOiA/c3RyaW5nLCBlbmRNYXJrOiA/c3RyaW5nKSB7XG4gICAgaWYgKF9lbmFibGVkKSB7XG4gICAgICBpbnZhcmlhbnQoXG4gICAgICAgIHR5cGVvZiBtZWFzdXJlTmFtZSA9PT0gJ3N0cmluZycgJiZcbiAgICAgICAgdHlwZW9mIHN0YXJ0TWFyayA9PT0gJ3N0cmluZycgJiZcbiAgICAgICAgdHlwZW9mIGVuZE1hcmsgPT09ICd1bmRlZmluZWQnLFxuICAgICAgICAnT25seSBwZXJmb3JtYW5jZS5tZWFzdXJlKHN0cmluZywgc3RyaW5nKSBvdmVybG9hZCBpcyBzdXBwb3J0ZWQuJ1xuICAgICAgKTtcbiAgICAgIGNvbnN0IHRvcE1hcmsgPSBfbWFya1N0YWNrW19tYXJrU3RhY2tJbmRleF07XG4gICAgICBpbnZhcmlhbnQoXG4gICAgICAgIHN0YXJ0TWFyayA9PT0gdG9wTWFyayxcbiAgICAgICAgJ1RoZXJlIHdhcyBhIG1pc21hdGNoaW5nIHBlcmZvcm1hbmNlLm1lYXN1cmUoKSBjYWxsLiAnICtcbiAgICAgICAgJ0V4cGVjdGVkIFwiJXNcIiBidXQgZ290IFwiJXMuXCInLFxuICAgICAgICB0b3BNYXJrLFxuICAgICAgICBzdGFydE1hcmssXG4gICAgICApO1xuICAgICAgX21hcmtTdGFja0luZGV4LS07XG4gICAgICAvLyBXZSBjYW4ndCB1c2UgbW9yZSBkZXNjcmlwdGl2ZSBtZWFzdXJlTmFtZSBiZWNhdXNlIFN5c3RyYWNlIGRvZXNuJ3RcbiAgICAgIC8vIGxldCB1cyBlZGl0IGxhYmVscyBwb3N0IGZhY3R1bS5cbiAgICAgIFN5c3RyYWNlLmVuZEV2ZW50KCk7XG4gICAgfVxuICB9LFxuICBjbGVhck1hcmtzKG1hcmtOYW1lOiBzdHJpbmcpIHtcbiAgICBpZiAoX2VuYWJsZWQpIHtcbiAgICAgIGlmIChfbWFya1N0YWNrSW5kZXggPT09IC0xKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGlmIChtYXJrTmFtZSA9PT0gX21hcmtTdGFja1tfbWFya1N0YWNrSW5kZXhdKSB7XG4gICAgICAgIC8vIFJlYWN0IHVzZXMgdGhpcyBmb3IgXCJjYW5jZWxsaW5nXCIgc3RhcnRlZCBtZWFzdXJlbWVudHMuXG4gICAgICAgIC8vIFN5c3RyYWNlIGRvZXNuJ3Qgc3VwcG9ydCBkZWxldGluZyBtZWFzdXJlbWVudHMsIHNvIHdlIGp1c3Qgc3RvcCB0aGVtLlxuICAgICAgICBpZiAodXNlclRpbWluZ1BvbHlmaWxsICE9IG51bGwpIHtcbiAgICAgICAgICB1c2VyVGltaW5nUG9seWZpbGwubWVhc3VyZShtYXJrTmFtZSwgbWFya05hbWUpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBjbGVhck1lYXN1cmVzKCkge1xuICAgIC8vIFJlYWN0IGNhbGxzIHRoaXMgdG8gYXZvaWQgbWVtb3J5IGxlYWtzIGluIGJyb3dzZXJzLCBidXQgd2UgZG9uJ3Qga2VlcFxuICAgIC8vIG1lYXN1cmVtZW50cyBhbnl3YXkuXG4gIH0sXG59IDogbnVsbDtcblxuLy8gQSBob29rIHRvIGdldCBSZWFjdCBTdGFjayBtYXJrZXJzIGluIFN5c3RyYWNlLlxuY29uc3QgcmVhY3REZWJ1Z1Rvb2xIb29rID0gX19ERVZfXyA/IHtcbiAgb25CZWZvcmVNb3VudENvbXBvbmVudChkZWJ1Z0lEKSB7XG4gICAgY29uc3QgUmVhY3RDb21wb25lbnRUcmVlSG9vayA9IHJlcXVpcmUoJ1JlYWN0R2xvYmFsU2hhcmVkU3RhdGUnKS5SZWFjdENvbXBvbmVudFRyZWVIb29rO1xuICAgIGNvbnN0IGRpc3BsYXlOYW1lID0gUmVhY3RDb21wb25lbnRUcmVlSG9vay5nZXREaXNwbGF5TmFtZShkZWJ1Z0lEKTtcbiAgICBTeXN0cmFjZS5iZWdpbkV2ZW50KGBSZWFjdFJlY29uY2lsZXIubW91bnRDb21wb25lbnQoJHtkaXNwbGF5TmFtZX0pYCk7XG4gIH0sXG4gIG9uTW91bnRDb21wb25lbnQoZGVidWdJRCkge1xuICAgIFN5c3RyYWNlLmVuZEV2ZW50KCk7XG4gIH0sXG4gIG9uQmVmb3JlVXBkYXRlQ29tcG9uZW50KGRlYnVnSUQpIHtcbiAgICBjb25zdCBSZWFjdENvbXBvbmVudFRyZWVIb29rID0gcmVxdWlyZSgnUmVhY3RHbG9iYWxTaGFyZWRTdGF0ZScpLlJlYWN0Q29tcG9uZW50VHJlZUhvb2s7XG4gICAgY29uc3QgZGlzcGxheU5hbWUgPSBSZWFjdENvbXBvbmVudFRyZWVIb29rLmdldERpc3BsYXlOYW1lKGRlYnVnSUQpO1xuICAgIFN5c3RyYWNlLmJlZ2luRXZlbnQoYFJlYWN0UmVjb25jaWxlci51cGRhdGVDb21wb25lbnQoJHtkaXNwbGF5TmFtZX0pYCk7XG4gIH0sXG4gIG9uVXBkYXRlQ29tcG9uZW50KGRlYnVnSUQpIHtcbiAgICBTeXN0cmFjZS5lbmRFdmVudCgpO1xuICB9LFxuICBvbkJlZm9yZVVubW91bnRDb21wb25lbnQoZGVidWdJRCkge1xuICAgIGNvbnN0IFJlYWN0Q29tcG9uZW50VHJlZUhvb2sgPSByZXF1aXJlKCdSZWFjdEdsb2JhbFNoYXJlZFN0YXRlJykuUmVhY3RDb21wb25lbnRUcmVlSG9vaztcbiAgICBjb25zdCBkaXNwbGF5TmFtZSA9IFJlYWN0Q29tcG9uZW50VHJlZUhvb2suZ2V0RGlzcGxheU5hbWUoZGVidWdJRCk7XG4gICAgU3lzdHJhY2UuYmVnaW5FdmVudChgUmVhY3RSZWNvbmNpbGVyLnVubW91bnRDb21wb25lbnQoJHtkaXNwbGF5TmFtZX0pYCk7XG4gIH0sXG4gIG9uVW5tb3VudENvbXBvbmVudChkZWJ1Z0lEKSB7XG4gICAgU3lzdHJhY2UuZW5kRXZlbnQoKTtcbiAgfSxcbiAgb25CZWdpbkxpZmVDeWNsZVRpbWVyKGRlYnVnSUQsIHRpbWVyVHlwZSkge1xuICAgIGNvbnN0IFJlYWN0Q29tcG9uZW50VHJlZUhvb2sgPSByZXF1aXJlKCdSZWFjdEdsb2JhbFNoYXJlZFN0YXRlJykuUmVhY3RDb21wb25lbnRUcmVlSG9vaztcbiAgICBjb25zdCBkaXNwbGF5TmFtZSA9IFJlYWN0Q29tcG9uZW50VHJlZUhvb2suZ2V0RGlzcGxheU5hbWUoZGVidWdJRCk7XG4gICAgU3lzdHJhY2UuYmVnaW5FdmVudChgJHtkaXNwbGF5TmFtZX0uJHt0aW1lclR5cGV9KClgKTtcbiAgfSxcbiAgb25FbmRMaWZlQ3ljbGVUaW1lcihkZWJ1Z0lELCB0aW1lclR5cGUpIHtcbiAgICBTeXN0cmFjZS5lbmRFdmVudCgpO1xuICB9LFxufSA6IG51bGw7XG5cbmNvbnN0IFN5c3RyYWNlID0ge1xuICBpbnN0YWxsUmVhY3RIb29rKHVzZUZpYmVyOiBib29sZWFuKSB7XG4gICAgaWYgKF9lbmFibGVkKSB7XG4gICAgICBpZiAoX19ERVZfXykge1xuICAgICAgICBpZiAodXNlRmliZXIpIHtcbiAgICAgICAgICBnbG9iYWwucGVyZm9ybWFuY2UgPSB1c2VyVGltaW5nUG9seWZpbGw7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmVxdWlyZSgnUmVhY3REZWJ1Z1Rvb2wnKS5hZGRIb29rKHJlYWN0RGVidWdUb29sSG9vayk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgX3VzZUZpYmVyID0gdXNlRmliZXI7XG4gICAgX2Nhbkluc3RhbGxSZWFjdEhvb2sgPSB0cnVlO1xuICB9LFxuXG4gIHNldEVuYWJsZWQoZW5hYmxlZDogYm9vbGVhbikge1xuICAgIGlmIChfZW5hYmxlZCAhPT0gZW5hYmxlZCkge1xuICAgICAgaWYgKF9fREVWX18pIHtcbiAgICAgICAgaWYgKGVuYWJsZWQpIHtcbiAgICAgICAgICBnbG9iYWwubmF0aXZlVHJhY2VCZWdpbkxlZ2FjeSAmJiBnbG9iYWwubmF0aXZlVHJhY2VCZWdpbkxlZ2FjeShUUkFDRV9UQUdfSlNDX0NBTExTKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBnbG9iYWwubmF0aXZlVHJhY2VFbmRMZWdhY3kgJiYgZ2xvYmFsLm5hdGl2ZVRyYWNlRW5kTGVnYWN5KFRSQUNFX1RBR19KU0NfQ0FMTFMpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChfY2FuSW5zdGFsbFJlYWN0SG9vaykge1xuICAgICAgICAgIGlmIChfdXNlRmliZXIpIHtcbiAgICAgICAgICAgIGdsb2JhbC5wZXJmb3JtYW5jZSA9IGVuYWJsZWQgPyB1c2VyVGltaW5nUG9seWZpbGwgOiB1bmRlZmluZWQ7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IFJlYWN0RGVidWdUb29sID0gcmVxdWlyZSgnUmVhY3REZWJ1Z1Rvb2wnKTtcbiAgICAgICAgICAgIGlmIChlbmFibGVkKSB7XG4gICAgICAgICAgICAgIFJlYWN0RGVidWdUb29sLmFkZEhvb2socmVhY3REZWJ1Z1Rvb2xIb29rKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIFJlYWN0RGVidWdUb29sLnJlbW92ZUhvb2socmVhY3REZWJ1Z1Rvb2xIb29rKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIF9lbmFibGVkID0gZW5hYmxlZDtcbiAgICB9XG4gIH0sXG5cbiAgaXNFbmFibGVkKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiBfZW5hYmxlZDtcbiAgfSxcblxuICAvKipcbiAgICogYmVnaW5FdmVudC9lbmRFdmVudCBmb3Igc3RhcnRpbmcgYW5kIHRoZW4gZW5kaW5nIGEgcHJvZmlsZSB3aXRoaW4gdGhlIHNhbWUgY2FsbCBzdGFjayBmcmFtZVxuICAqKi9cbiAgYmVnaW5FdmVudChwcm9maWxlTmFtZT86IGFueSwgYXJncz86IGFueSkge1xuICAgIGlmIChfZW5hYmxlZCkge1xuICAgICAgcHJvZmlsZU5hbWUgPSB0eXBlb2YgcHJvZmlsZU5hbWUgPT09ICdmdW5jdGlvbicgP1xuICAgICAgICBwcm9maWxlTmFtZSgpIDogcHJvZmlsZU5hbWU7XG4gICAgICBnbG9iYWwubmF0aXZlVHJhY2VCZWdpblNlY3Rpb24oVFJBQ0VfVEFHX1JFQUNUX0FQUFMsIHByb2ZpbGVOYW1lLCBhcmdzKTtcbiAgICB9XG4gIH0sXG5cbiAgZW5kRXZlbnQoKSB7XG4gICAgaWYgKF9lbmFibGVkKSB7XG4gICAgICBnbG9iYWwubmF0aXZlVHJhY2VFbmRTZWN0aW9uKFRSQUNFX1RBR19SRUFDVF9BUFBTKTtcbiAgICB9XG4gIH0sXG5cbiAgLyoqXG4gICAqIGJlZ2luQXN5bmNFdmVudC9lbmRBc3luY0V2ZW50IGZvciBzdGFydGluZyBhbmQgdGhlbiBlbmRpbmcgYSBwcm9maWxlIHdoZXJlIHRoZSBlbmQgY2FuIGVpdGhlclxuICAgKiBvY2N1ciBvbiBhbm90aGVyIHRocmVhZCBvciBvdXQgb2YgdGhlIGN1cnJlbnQgc3RhY2sgZnJhbWUsIGVnIGF3YWl0XG4gICAqIHRoZSByZXR1cm5lZCBjb29raWUgdmFyaWFibGUgc2hvdWxkIGJlIHVzZWQgYXMgaW5wdXQgaW50byB0aGUgZW5kQXN5bmNFdmVudCBjYWxsIHRvIGVuZCB0aGUgcHJvZmlsZVxuICAqKi9cbiAgYmVnaW5Bc3luY0V2ZW50KHByb2ZpbGVOYW1lPzogYW55KTogYW55IHtcbiAgICBjb25zdCBjb29raWUgPSBfYXN5bmNDb29raWU7XG4gICAgaWYgKF9lbmFibGVkKSB7XG4gICAgICBfYXN5bmNDb29raWUrKztcbiAgICAgIHByb2ZpbGVOYW1lID0gdHlwZW9mIHByb2ZpbGVOYW1lID09PSAnZnVuY3Rpb24nID9cbiAgICAgICAgcHJvZmlsZU5hbWUoKSA6IHByb2ZpbGVOYW1lO1xuICAgICAgZ2xvYmFsLm5hdGl2ZVRyYWNlQmVnaW5Bc3luY1NlY3Rpb24oVFJBQ0VfVEFHX1JFQUNUX0FQUFMsIHByb2ZpbGVOYW1lLCBjb29raWUsIDApO1xuICAgIH1cbiAgICByZXR1cm4gY29va2llO1xuICB9LFxuXG4gIGVuZEFzeW5jRXZlbnQocHJvZmlsZU5hbWU/OiBhbnksIGNvb2tpZT86IGFueSkge1xuICAgIGlmIChfZW5hYmxlZCkge1xuICAgICAgcHJvZmlsZU5hbWUgPSB0eXBlb2YgcHJvZmlsZU5hbWUgPT09ICdmdW5jdGlvbicgP1xuICAgICAgICBwcm9maWxlTmFtZSgpIDogcHJvZmlsZU5hbWU7XG4gICAgICBnbG9iYWwubmF0aXZlVHJhY2VFbmRBc3luY1NlY3Rpb24oVFJBQ0VfVEFHX1JFQUNUX0FQUFMsIHByb2ZpbGVOYW1lLCBjb29raWUsIDApO1xuICAgIH1cbiAgfSxcblxuICAvKipcbiAgICogY291bnRlckV2ZW50IHJlZ2lzdGVycyB0aGUgdmFsdWUgdG8gdGhlIHByb2ZpbGVOYW1lIG9uIHRoZSBzeXN0cmFjZSB0aW1lbGluZVxuICAqKi9cbiAgY291bnRlckV2ZW50KHByb2ZpbGVOYW1lPzogYW55LCB2YWx1ZT86IGFueSkge1xuICAgIGlmIChfZW5hYmxlZCkge1xuICAgICAgcHJvZmlsZU5hbWUgPSB0eXBlb2YgcHJvZmlsZU5hbWUgPT09ICdmdW5jdGlvbicgP1xuICAgICAgICBwcm9maWxlTmFtZSgpIDogcHJvZmlsZU5hbWU7XG4gICAgICBnbG9iYWwubmF0aXZlVHJhY2VDb3VudGVyICYmXG4gICAgICAgIGdsb2JhbC5uYXRpdmVUcmFjZUNvdW50ZXIoVFJBQ0VfVEFHX1JFQUNUX0FQUFMsIHByb2ZpbGVOYW1lLCB2YWx1ZSk7XG4gICAgfVxuICB9LFxuXG4gIC8qKlxuICAgKiBSZWxheSBwcm9maWxlcyB1c2UgYXdhaXQgY2FsbHMsIHNvIGxpa2VseSBvY2N1ciBvdXQgb2YgY3VycmVudCBzdGFjayBmcmFtZVxuICAgKiB0aGVyZWZvcmUgYXN5bmMgdmFyaWFudCBvZiBwcm9maWxpbmcgaXMgdXNlZFxuICAqKi9cbiAgYXR0YWNoVG9SZWxheVByb2ZpbGVyKHJlbGF5UHJvZmlsZXI6IFJlbGF5UHJvZmlsZXIpIHtcbiAgICByZWxheVByb2ZpbGVyLmF0dGFjaFByb2ZpbGVIYW5kbGVyKCcqJywgKG5hbWUpID0+IHtcbiAgICAgIGNvbnN0IGNvb2tpZSA9IFN5c3RyYWNlLmJlZ2luQXN5bmNFdmVudChuYW1lKTtcbiAgICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgIFN5c3RyYWNlLmVuZEFzeW5jRXZlbnQobmFtZSwgY29va2llKTtcbiAgICAgIH07XG4gICAgfSk7XG5cbiAgICByZWxheVByb2ZpbGVyLmF0dGFjaEFnZ3JlZ2F0ZUhhbmRsZXIoJyonLCAobmFtZSwgY2FsbGJhY2spID0+IHtcbiAgICAgIFN5c3RyYWNlLmJlZ2luRXZlbnQobmFtZSk7XG4gICAgICBjYWxsYmFjaygpO1xuICAgICAgU3lzdHJhY2UuZW5kRXZlbnQoKTtcbiAgICB9KTtcbiAgfSxcblxuICAvKiBUaGlzIGlzIG5vdCBjYWxsZWQgYnkgZGVmYXVsdCBkdWUgdG8gcGVyZiBvdmVyaGVhZCBidXQgaXQncyB1c2VmdWxcbiAgICAgaWYgeW91IHdhbnQgdG8gZmluZCB0cmFjZXMgd2hpY2ggc3BlbmQgdG9vIG11Y2ggdGltZSBpbiBKU09OLiAqL1xuICBzd2l6emxlSlNPTigpIHtcbiAgICBTeXN0cmFjZS5tZWFzdXJlTWV0aG9kcyhKU09OLCAnSlNPTicsIFtcbiAgICAgICdwYXJzZScsXG4gICAgICAnc3RyaW5naWZ5J1xuICAgIF0pO1xuICB9LFxuXG4gLyoqXG4gICogTWVhc3VyZXMgbXVsdGlwbGUgbWV0aG9kcyBvZiBhIGNsYXNzLiBGb3IgZXhhbXBsZSwgeW91IGNhbiBkbzpcbiAgKiBTeXN0cmFjZS5tZWFzdXJlTWV0aG9kcyhKU09OLCAnSlNPTicsIFsncGFyc2UnLCAnc3RyaW5naWZ5J10pO1xuICAqXG4gICogQHBhcmFtIG9iamVjdFxuICAqIEBwYXJhbSBvYmplY3ROYW1lXG4gICogQHBhcmFtIG1ldGhvZE5hbWVzIE1hcCBmcm9tIG1ldGhvZCBuYW1lcyB0byBtZXRob2QgZGlzcGxheSBuYW1lcy5cbiAgKi9cbiBtZWFzdXJlTWV0aG9kcyhvYmplY3Q6IGFueSwgb2JqZWN0TmFtZTogc3RyaW5nLCBtZXRob2ROYW1lczogQXJyYXk8c3RyaW5nPik6IHZvaWQge1xuICAgaWYgKCFfX0RFVl9fKSB7XG4gICAgIHJldHVybjtcbiAgIH1cblxuICAgbWV0aG9kTmFtZXMuZm9yRWFjaChtZXRob2ROYW1lID0+IHtcbiAgICAgb2JqZWN0W21ldGhvZE5hbWVdID0gU3lzdHJhY2UubWVhc3VyZShcbiAgICAgICBvYmplY3ROYW1lLFxuICAgICAgIG1ldGhvZE5hbWUsXG4gICAgICAgb2JqZWN0W21ldGhvZE5hbWVdXG4gICAgICk7XG4gICB9KTtcbiB9LFxuXG4gLyoqXG4gICogUmV0dXJucyBhbiBwcm9maWxlZCB2ZXJzaW9uIG9mIHRoZSBpbnB1dCBmdW5jdGlvbi4gRm9yIGV4YW1wbGUsIHlvdSBjYW46XG4gICogSlNPTi5wYXJzZSA9IFN5c3RyYWNlLm1lYXN1cmUoJ0pTT04nLCAncGFyc2UnLCBKU09OLnBhcnNlKTtcbiAgKlxuICAqIEBwYXJhbSBvYmpOYW1lXG4gICogQHBhcmFtIGZuTmFtZVxuICAqIEBwYXJhbSB7ZnVuY3Rpb259IGZ1bmNcbiAgKiBAcmV0dXJuIHtmdW5jdGlvbn0gcmVwbGFjZW1lbnQgZnVuY3Rpb25cbiAgKi9cbiBtZWFzdXJlKG9iak5hbWU6IHN0cmluZywgZm5OYW1lOiBzdHJpbmcsIGZ1bmM6IGFueSk6IGFueSB7XG4gICBpZiAoIV9fREVWX18pIHtcbiAgICAgcmV0dXJuIGZ1bmM7XG4gICB9XG5cbiAgIGNvbnN0IHByb2ZpbGVOYW1lID0gYCR7b2JqTmFtZX0uJHtmbk5hbWV9YDtcbiAgIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICAgaWYgKCFfZW5hYmxlZCkge1xuICAgICAgIHJldHVybiBmdW5jLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgIH1cblxuICAgICBTeXN0cmFjZS5iZWdpbkV2ZW50KHByb2ZpbGVOYW1lKTtcbiAgICAgY29uc3QgcmV0ID0gZnVuYy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICBTeXN0cmFjZS5lbmRFdmVudCgpO1xuICAgICByZXR1cm4gcmV0O1xuICAgfTtcbiB9LFxufTtcblxuaWYgKF9fREVWX18pIHtcbiAgLy8gVGhpcyBpcyBuZWVkZWQsIGJlY2F1c2UgcmVxdWlyZSBjYWxsaXMgaW4gcG9seWZpbGxzIGFyZSBub3QgcHJvY2Vzc2VkIGFzXG4gIC8vIG90aGVyIGZpbGVzLiBUaGVyZWZvcmUsIGNhbGxzIHRvIGByZXF1aXJlKCdtb2R1bGVJZCcpYCBhcmUgbm90IHJlcGxhY2VkXG4gIC8vIHdpdGggbnVtZXJpYyBJRHNcbiAgLy8gVE9ETyhkYXZpZGF1cmVsaW8pIFNjYW4gcG9seWZpbGxzIGZvciBkZXBlbmRlbmNpZXMsIHRvbyAodDk3NTk2ODYpXG4gIChyZXF1aXJlOiBhbnkpLlN5c3RyYWNlID0gU3lzdHJhY2U7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gU3lzdHJhY2U7XG4iXX0=